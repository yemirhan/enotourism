generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["referentialIntegrity"]
}

datasource db {
  provider             = "mysql"
  url                  = env("DATABASE_URL")
  referentialIntegrity = "prisma"
}

generator zod {
  provider = "prisma-zod-generator"
}

enum UserType {
  GUIDE
  WINERY
  TASTER
}

enum Gender {
  MALE
  FEMALE
  OTHER
}

enum CountryList {
  Albania
  Argentina
  Armenia
  Australia
  Austria
  Azerbaijan
  Belgium
  Bolivia
  BosniaHerzegovina
  Brazil
  Bulgaria
  Canada
  Chile
  China
  Croatia
  Cyprus
  CzechRepublic
  Denmark
  Estonia
  Finland
  France
  Georgia
  Germany
  Greece
  Hungary
  Israel
  Italy
  Kazakhstan
  Latvia
  Lebanon
  Lithuania
  Luxembourg
  Malta
  Mexico
  Moldova
  Montenegro
  Morocco
  Namibia
  Netherlands
  NewZealand
  NorthernMacedonia
  Peru
  Poland
  Portugal
  Romania
  Russia
  Serbia
  Slovakia
  Slovenia
  SouthAfrica
  Spain
  Sweden
  Switzerland
  Thailand
  Turkey
  Ukraine
  UnitedKingdom
  Uruguay
  USA
  Uzbekistan
  Vietnam
}

model User {
  id           String           @id @default(cuid())
  email        String           @unique
  password     String
  name         String?
  surname      String?
  gender       Gender?          @default(OTHER)
  phone_number String?
  address      Address?
  photo        String?          @default("https://media.istockphoto.com/id/1288129985/vector/missing-image-of-a-person-placeholder.jpg?s=612x612&w=0&k=20&c=9kE777krx5mrFHsxx02v60ideRWvIgI1RWzR1X4MG2Y=")
  about        String?
  user_type    UserType         @default(TASTER)
  Winery       Winery[]
  Tour         Tour[]
  Reservation  Reservation[]
  time_slots   GuideTimeSlots[]
  createdAt    DateTime         @default(now())
  updatedAt    DateTime         @updatedAt
}

model Address {
  id                 String       @id @default(cuid())
  street             String
  city               String
  flat               String?
  address            String
  is_contact_address Boolean      @default(true)
  postcode           String?
  country            CountryList?
  // region             Region[]
  user_id            String       @unique
  user               User         @relation(fields: [user_id], references: [id])
  Winery             Winery[]
}

model Country {
  id          String          @id @default(cuid())
  name        String
  photos      CountryPhotos[]
  description String
  //Address     Address?        @relation(fields: [addressId], references: [id])
  //addressId   String?
}

model CountryPhotos {
  id        String  @id @default(cuid())
  countryId String
  country   Country @relation(fields: [countryId], references: [id])
  url       String
}

model RegionPhotos {
  id       String @id @default(cuid())
  regionId String
  region   Region @relation(fields: [regionId], references: [id])
  url      String
}

model Region {
  id          String         @id @default(cuid())
  name        String
  photos      RegionPhotos[]
  description String
  // Address     Address?       @relation(fields: [addressId], references: [id])
  // addressId   String?
}

model Winery {
  id           String         @id @default(cuid())
  name         String
  description  String
  photos       WineryPhotos[]
  address      Address?       @relation(fields: [addressId], references: [id])
  addressId    String?
  email        String
  history      String
  awards       String
  language     Language[]
  owner        User           @relation(fields: [userId], references: [id])
  userId       String
  WorkingHours WorkingHours[]
  Tour         Tour[]
  Wine         Wine[]
  Offer        Offer[]
}

model WineryPhotos {
  id       String @id @default(cuid())
  wineryId String
  winery   Winery @relation(fields: [wineryId], references: [id])
  url      String
}

model Language {
  id       String  @id @default(cuid())
  name     String
  flag     String
  Winery   Winery? @relation(fields: [wineryId], references: [id])
  wineryId String?
}

model WorkingHours {
  id       String  @id @default(cuid())
  day      String
  open     String
  close    String
  Winery   Winery? @relation(fields: [wineryId], references: [id])
  wineryId String?
}

model Tour {
  id               String  @id @default(cuid())
  name             String
  description      String
  number_of_people Int
  Winery           Winery? @relation(fields: [wineryId], references: [id])
  wineryId         String?
  tour_guide       User    @relation(fields: [userId], references: [id])
  userId           String
}

model Wine {
  id                String   @id @default(cuid())
  name              String
  brief_description String
  wine_type         WineType @relation(fields: [wineTypeId], references: [id])
  Winery            Winery   @relation(fields: [wineryId], references: [id])
  wineryId          String
  wineTypeId        String
}

model WineType {
  id      String @id @default(cuid())
  name    String
  color   String
  taste   String
  grapes  String
  texture String
  Wine    Wine[]
}

model Offer {
  id                   String          @id @default(cuid())
  name                 String
  description          String
  price                Int
  winery               Winery          @relation(fields: [wineryId], references: [id])
  offer_types          OfferType[]
  adult_price          Decimal
  kid_price            Decimal
  photos               OfferPhoto[]
  max_number_of_people Int
  duration             Int
  wineryId             String
  OfferTimeSlot        OfferTimeSlot[]
  Reservation          Reservation[]
}

model OfferPhoto {
  id      String @id @default(cuid())
  offerId String
  offer   Offer  @relation(fields: [offerId], references: [id])
  url     String
}

model OfferType {
  id      String @id @default(cuid())
  name    String
  offers  Offer  @relation(fields: [offerId], references: [id])
  offerId String
}

model OfferTimeSlot {
  id        String   @id @default(cuid())
  date      DateTime
  startTime Int
  endTime   Int
  offerId   String
  offer     Offer    @relation(fields: [offerId], references: [id])
}

enum StatusType {
  PENDING
  ACCEPTED
  REJECTED
  DONE
}

enum Days {
  MONDAY
  TUESDAY
  WEDNESDAY
  THURSDAY
  FRIDAY
  SATURDAY
  SUNDAY
}

model GuideTimeSlots {
  id        String @id @default(cuid())
  date      Days
  startTime Int
  endTime   Int
  guideId   String
  guide     User   @relation(fields: [guideId], references: [id])
}

model Status {
  id     String     @id @default(cuid())
  status StatusType @default(PENDING)

  Reservation Reservation[]
}

model Reservation {
  id               String   @id @default(cuid())
  date             DateTime
  from_time        Int
  to_time          Int
  slug             String
  number_of_people Int
  number_of_kids   Int
  offerId          String
  offer            Offer    @relation(fields: [offerId], references: [id])
  statusId         String
  status           Status   @relation(fields: [statusId], references: [id])
  userId           String
  user             User     @relation(fields: [userId], references: [id])
}
